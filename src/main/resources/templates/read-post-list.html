<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">

<div layout:fragment="content">
    <h1>글 목록</h1>
    <div>
        <form>
            <label for="keyword">게시글 검색</label>
            <input id="keyword" type="text" placeholder="검색어를 입력하세요">

            <label for="type">검색 조건</label>
            <select id="type">
                <option value="title">제목</option>
                <option value="content">내용</option>
            </select>
            <button type="button" id="btn-search-post">검색</button>
        </form>
    </div>
    <div class="col-md-12">
        <div class="row">
            <div class="col-md-6">
                <a href="/" role="button" class="btn btn-info">홈으로</a>
                <a href="/setting" role="button" class="btn btn-primary">마이 페이지</a>
                <a href="/logout" class="btn btn-info active" role="button">Logout</a>
            </div>
        </div>
        <br>
        <div class="row">
            <div class="col-md-6">
                <a href="/write" role="button" class="btn btn-primary">글 등록</a>
                <a href="/categories" role="button" class="btn btn-secondary">카테고리 목록</a>
                <a th:if="${user.userRole == 'ADMIN'}" href="/category/add" role="button" class="btn btn-success">카테고리 추가</a>
            </div>
        </div>
    </div>
    <br>
    <table class="table table-horizontal table-bordered">
        <thead class="thead-strong">
        <tr>
            <th>게시글 번호</th>
            <th>조회수</th>
            <th>제목</th>
            <th>작성자</th>
            <th>최종 수정일</th>
        </tr>
        </thead>
        <tbody id="tbody">
            <tr th:each="post : ${postList}">
                <td th:text="${post.id}"></td>
                <td th:text="${post.views}"></td>
                <td><a th:href="@{/post/{id}(id=${post.id})}" th:text="${post.title}"></a></td>
                <td th:if="${post.userRole == 'ROLE_ADMIN'}" th:text="|${post.userName}(ADMIN)|"></td>
                <td th:unless="${post.userRole == 'ROLE_ADMIN'}" th:text="${post.userName}"></td>
                <td th:text="${post.modifiedDate}"></td>
            </tr>
        </tbody>
    </table>
    <div>
        <!--버튼은 페이지 시작부터 5개만 노출(page=2 -> 2~6까지 다섯개)-->

        <span th:if="${postSearch.page eq 1}">
            <a th:text="'<'" role="button" class="btn btn-info"></a>
        </span>
        <span th:if="${postSearch.page ne 1}">
            <a th:href="@{/posts(page=${postSearch.page - 1}, size=${postSearch.size})}"
               th:text="'<'" role="button" class="btn btn-info"></a>
        </span>

        <span th:if="${postSearch.page gt 2}">
            <a th:href="@{/posts(page=1, size=${postSearch.size})}"
               th:text="1" role="button" class="btn btn-info"></a>
        </span>
        <span th:if="${postSearch.page gt 2}">...</span>

        <span th:if="${postSearch.page le postPageLowerLimit}" th:each="num : ${pageCounts}">
            <a th:if="${((postSearch.page - 2) le num) and (num le postPageUpperLimit)}"
               th:href="@{/posts(page=${num}, size=${postSearch.size})}"
               th:text="${num}" role="button" class="btn btn-info"></a>
        </span>
        <span th:if="${postSearch.page gt postPageLowerLimit}" th:each="num : ${pageCounts}">
            <a th:if="${(postSearch.page gt postPageLowerLimit) and (num gt postPageLowerLimit)}"
               th:href="@{/posts(page=${num}, size=${postSearch.size})}"
               th:text="${num}" role="button" class="btn btn-info"></a>
        </span>

        <span th:if="${(pageCounts.size gt 10) and (postSearch.page le postPageLowerLimit)}">...</span>
        <span th:if="${(pageCounts.size gt 10) and (postSearch.page le postPageLowerLimit)}">
            <a th:href="@{/posts(page=${pageCounts.size}, size=${postSearch.size})}"
               th:text="${pageCounts.size}" role="button" class="btn btn-info"></a>
        </span>

        <span th:if="${postSearch.page eq pageCounts.size}">
            <a th:text="'>'" role="button" class="btn btn-info"></a>
        </span>
        <span th:if="${postSearch.page ne pageCounts.size}">
            <a th:href="@{/posts(page=${postSearch.page + 1}, size=${postSearch.size})}"
               th:text="'>'" role="button" class="btn btn-info"></a>
        </span>
    </div>
</div>

